# 分布式系统CAP定理

C：一致性，这里指的是强一致性

A：可用性

一般用宕机时长来衡量系统的可用性，宕机时长占全年总服务时间的比例  

P：分区容错性

现在大型的应用都有异地机房来做容灾（两岸三地多机房），这些机房的数据是在互相的同步和备份，假如在某两台机器之间，数据同步的渠道被切断了，那么就会造成数据的不一致性，这时对一个想要支持分区容错性的系统来说，就面临着艰难的二选一的境地：

1. 兼顾可用性，两个机房继续提供服务，但是数据不一致，请求A机房和请求B机房的数据可能是不一样的。这样就牺牲了 C 一致性
2. 保证一致性，那就需要阻塞在这里，等待数据同步回复以后，再提供服务，这样就牺牲了高可用

CAP定理：分布式系统只能CAP中的两个，且只能是CP或者AP，没有CA。但是作为分布式项目的初衷就是保证系统的高可用，因此我们都会选择AP



# 服务治理组建比较

|          | Eureka               | Consul                                                       | Nacos            |
| -------- | -------------------- | ------------------------------------------------------------ | ---------------- |
| 一致性   | 弱一致性（AP）       | 弱一致性（AP）                                               | AP / CP          |
| 性能     | 快（后面学习为啥快） | 慢（RAFT协议，Leader选举，leader挂掉，重新选举的过程中Consul是不可用的状态） | 快               |
| 网络协议 | HTTP                 | HTTP & DNS                                                   | HTTP & DNS & UDP |
| 应用广度 | 目前主流             | 非主流                                                       | 稳中有升         |



